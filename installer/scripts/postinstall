#!/bin/bash

# Define source and target directories
SOURCE_DIR="/Users/parker/Documents/dev/claude-engineer/_Projects/duplicate-file-and-update-name-with-timestamp-sh"
TARGET_DIR="/usr/local/bin"

# Copy scripts from source to target
cp "$SOURCE_DIR/DuplicateWithTimestamp.sh" "$TARGET_DIR/"
cp "$SOURCE_DIR/DuplicateFileManager.sh" "$TARGET_DIR/"

# Make scripts executable
chmod +x "$TARGET_DIR/DuplicateWithTimestamp.sh"
chmod +x "$TARGET_DIR/DuplicateFileManager.sh"

# Create necessary directories
mkdir -p "$HOME/.local/log"

# Add /usr/local/bin to PATH if it's not already there
if [[ ":$PATH:" != *":/usr/local/bin:"* ]]; then
    echo 'export PATH="/usr/local/bin:$PATH"' >> "$HOME/.bash_profile"
    echo 'export PATH="/usr/local/bin:$PATH"' >> "$HOME/.zshrc"
fi

# Install fswatch if not already installed
if ! command -v fswatch &> /dev/null; then
    if command -v brew &> /dev/null; then
        brew install fswatch
    else
        echo "Homebrew is not installed. Please install Homebrew and then install fswatch manually."
        echo "You can install Homebrew by running:"
        echo '/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"'
        echo "Then install fswatch by running:"
        echo "brew install fswatch"
    fi
fi

echo "Installation complete. Please restart your terminal or run 'source ~/.bash_profile' (or 'source ~/.zshrc' if using zsh) to update your PATH."
echo "You can now use the DuplicateFileManager.sh script to start and stop the service."